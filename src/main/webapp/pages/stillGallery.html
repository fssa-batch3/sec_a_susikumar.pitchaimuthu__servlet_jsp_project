<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Gallery</title>
<link rel="stylesheet" href="../assets/css/gallery.css" />
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

<link
	href="https://fonts.googleapis.com/css2?family=Kanit:wght@200;300;400;500;600;700;800;900&display=swap"
	rel="stylesheet" />

<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css" />
<style>
@import
	url("https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700;800&display=swap")
	;
</style>
</head>
<body>
	<header>
		<nav>
			<!-- nav inside div container -->

			<div class="nav-div-container">
				<div class="nav-inside-div-container">
					<!-- logo div -->
					<div class="logo-div">
						<img class="logo-image" src="../assets/images/logos/bird-logo.png"
							alt="logo-image" />
					</div>

					<!-- profile div container -->

					<div class="profile-name-image-div-container">
						<!-- profile div -->
						<div class="image-text">
							<!-- profile name div -->
							<div class="profile-naem-div">
								<p class="name"></p>
							</div>

							<!-- profile image div -->

							<div class="profile-div">
								<img id="profile-image" src="" alt="profile-image" />
							</div>
						</div>
					</div>
				</div>
			</div>
		</nav>
	</header>
	<section class="main-section-container">
		<section class="side-bar-section-container">
			<ul class="side-bar-option-div">
				<li class="all-photo-option-li"><i class="bi bi-unity heart"></i>
					<a id="side-bar-anger">All photos</a></li>
				<li class="latest-photo-option-li"><i class="bi bi-yelp heart"></i>
					<a id="side-bar-anger">Latest</a></li>

				<li class="favourite-photo-option-li"><i
					class="bi bi-suit-heart-fill heart"></i> <a id="side-bar-anger">Favourite</a>
				</li>

				<li class="recent-photo-option-li"><i
					class="bi bi-recycle heart"></i> <a id="side-bar-anger">Recently
						deleted</a></li>

				<li class="back-to-cam-li" id="go-to-camera"><i
					class="bi bi-camera-fill heart"></i> <a>Fresh cam</a></li>
			</ul>
		</section>

		<section class="second-section-container">
			<div class="image-filter-div-container">
				<div class="filter-image-div">
					<!--  filter image input and label-->

					<div class="filter-head-div">
						<p class="filter-head">Filter your images</p>
					</div>
					<div class="filter-input-label-div">
						<div class="filter-input-div">
							<label for="text">from</label> <input class="filter-input"
								id="from" type="date" />
						</div>
						<div class="filter-input-div">
							<label for="text">to</label> <input class="filter-input" id="to"
								type="date" />
						</div>
					</div>
					<div class="filter-button-div">
						<button class="filter-button">Filter</button>
					</div>
				</div>
			</div>

			<div class="still-showing-div-container">
				<div class="second-section-container-div"></div>
			</div>
		</section>
	</section>

	<!-- script files -->
	<script src="https://momentjs.com/downloads/moment.js"
		integrity="sha384-mFSRsfjTuXtihSLc/J0LxrFE1H9WRRllwGM6pxxyiYACkVdxRG82d3DQVlq8yXZM"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	
	<script>
      function getAllStills() {
        const url = "http://localhost:8080/appfreshnest/StillGalleryServlet";
        console.log(url);
        axios
          .get(url)
          .then(function (response) {
            // handle success
            console.log(response.data);
            const imageGallery = response.data;
            displayStills(imageGallery);
            console.log(imageGallery);
          })
          .catch(function (error) {
            // handle error
            console.log(error);
          });
      }
      function displayStills(imageGallery) {
        let content = "";

        try {
          for (let imagesGall of imageGallery) {
            content +=
              "<div class='card-container' id='" + imagesGall["stillId"] + "'>";
            content += "<div class='image-name-container'>";
            content +=
                "<a href='../pages/snap-details.html?stillId=" +
                imagesGall["stillId"] +
                "'>";
            content +=
              "<img id='" +
              imagesGall["stillId"] +
              "' src='" +
              imagesGall["stillUrl"] +
              "' alt='userSnaps' class='taking-image'>";
            content += "</a>";
            content +=
              "<p class='snap-name'>" + imagesGall["stillName"] + "</p>";
            content += "</div>";
            content += "</div>";
          }

          console.log(content);
          document.querySelector(".second-section-container-div").innerHTML =
            content;
        } catch (error) {
          console.log("An error occurred while showing the images: ", error);
        }
      }
      
      getAllStills();
      
      
      // Sets the user profile and name 
      
      try {
    	  let profile_image = document.querySelector("#profile-image");
    	  let profile_name = document.querySelector(".name");

    	  profile_image.setAttribute("src", findUser["avatarUrl"]);
    	  profile_name.innerHTML = findUser["userName"];
    	} catch (error) {
    	  console.log("An error occurred while set the user profile details :", error);
    	}
    	
    	// Filter stills according to the dates
    	
    	  let filterButton = document.querySelector(".filter-button");

// filter button add eventListener

filterButton.addEventListener("click", (event) => {
  event.preventDefault();

  try {
    let from = document.querySelector("#from").value;
    let to = document.querySelector("#to").value;
    
    let filterObject = {
      from: from,
      to: to
    };
    
    const url = "http://localhost:8080/appfreshnest/StillFilterServlet";

    axios.post(url, filterObject, {
      headers: {
        "Content-Type": "application/json"
      }
    })
    .then(function (response) {
      // handle success
      console.log(response.data);

      // Assuming you have a variable named serverMsg in the response data
      const serverMsg = response.data;
      console.log(serverMsg)

        removeCardElement();
        displayStills(response.data); // Assuming filterStills is a property in the response data
      
    })
    .catch(function (error) {
      // handle error
      console.log(error);
    });

  } catch (error) {
    console.error(error);
  }
});

//all photo showing add eventlIstener function
let imageContainer = document.querySelector(".second-section-container-div");

//Here creating function to remove the card element before creating the other element


function removeCardElement() {
  try {
    if (imageContainer.hasChildNodes()) {
      let image_div = document.querySelectorAll(".card-container");

      for (let cardDiv of image_div) {
        cardDiv.remove();
      }
    }
  } catch (error) {
    console.log("An error occured while removing the image card :", error);
  }
}
      
    </script>
</body>
</html>
